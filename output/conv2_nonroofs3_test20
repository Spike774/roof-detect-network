printer: <experiment_settings.PrintLogSave instance at 0x7f4c71e45440>
data_augmentation: True
scaler: StandardScaler
display_mistakes: True
non_roofs: 3
test_percent: 0.2
net: MyNeuralNet(X_tensor_type=None,
      batch_iterator_test=<FlipBatchIterator.CropOnlyBatchIterator object at 0x7f4c71ebadd0>,
      batch_iterator_train=<FlipBatchIterator.FlipBatchIterator object at 0x7f4c71ebae10>,
      conv1_filter_size=(3, 3), conv1_num_filters=32,
      conv2_filter_size=(2, 2), conv2_num_filters=64, custom_score=None,
      eval_size=0.2, input_shape=(None, 3, 32, 32),
      layers=[('input', <class 'lasagne.layers.input.InputLayer'>), ('conv1', <class 'lasagne.layers.conv.Conv2DLayer'>), ('pool1', <class 'lasagne.layers.pool.MaxPool2DLayer'>), ('conv2', <class 'lasagne.layers.conv.Conv2DLayer'>), ('pool2', <class 'lasagne.layers.pool.MaxPool2DLayer'>), ('output', <class 'lasagne.layers.dense.DenseLayer'>)],
      loss=None, max_epochs=250, more_params={},
      net_name='conv2_nonroofs3_test20',
      objective=<class 'lasagne.objectives.Objective'>,
      objective_loss_function=<function categorical_crossentropy at 0x7f4c8c98c8c0>,
      on_epoch_finished=[<experiment_settings.PrintLogSave instance at 0x7f4c71e45440>, <nolearn.lasagne.handlers.PrintLog instance at 0x7f4c71e455f0>],
      on_training_finished=[],
      on_training_started=[<experiment_settings.SaveLayerInfo instance at 0x7f4c71e45560>, <nolearn.lasagne.handlers.PrintLayerInfo instance at 0x7f4c71e45638>],
      output_nonlinearity=<function softmax at 0x7f4c7bd98938>,
      output_num_units=3, pool1_pool_size=(2, 2), pool2_pool_size=(2, 2),
      preproc_scaler=None, regression=False,
      update=<function nesterov_momentum at 0x7f4c7bc421b8>,
      update_learning_rate=0.01, update_momentum=0.9,
      use_label_encoder=False, verbose=1,
      y_tensor_type=TensorType(int32, vector))
preloaded: False

# Neural Network with 18563 learnable parameters
## Layer information

  #  name    size
---  ------  --------
  0  input   3x32x32
  1  conv1   32x30x30
  2  pool1   32x15x15
  3  conv2   64x14x14
  4  pool2   64x7x7
  5  output  3 

1	0.591367216619	0.448276663421	1.31920143267	0.823690878378
2	0.372599273039	0.359227346869	1.03722413198	0.855539132883
3	0.291806340059	0.286107389777	1.01991892026	0.88963963964
4	0.265555315848	0.274130402867	0.968718949343	0.911071227477
5	0.254277817909	0.246765159627	1.03044456638	0.910719313063
6	0.229370356467	0.233875165575	0.980738403341	0.919481981982
7	0.214454803581	0.216414175398	0.990946194664	0.918179898649
8	0.202503214863	0.230565463393	0.878289453601	0.916877815315
9	0.187559126664	0.168921597089	1.11033242579	0.943165822072
10	0.182691510542	0.152424601182	1.19856971332	0.948022240991
11	0.162340178559	0.155919156078	1.04118174214	0.950274493243
12	0.153766525476	0.145932004692	1.05368610402	0.943517736486
13	0.153139786164	0.172833759226	0.886052509933	0.945769988739
14	0.140799074188	0.117705528382	1.19619763085	0.954884572072
15	0.136529743678	0.110612582301	1.23430572578	0.961043074324
16	0.132526288592	0.101560291921	1.30490259613	0.961993243243
17	0.126133065767	0.106753304054	1.18153781641	0.962943412162
18	0.116062881744	0.125536079823	0.924538044424	0.955834740991
19	0.117854362762	0.0946303458384	1.24541828224	0.963295326577
20	0.103969497501	0.0948006398713	1.09671725467	0.965547578829
21	0.0968920764814	0.0962004402208	1.00718953322	0.969805743243
22	0.10285903589	0.0908866929126	1.13172822769	0.964949324324
23	0.0898084938195	0.0864913008709	1.0383529085	0.970755912162
24	0.0909569736214	0.0909815981463	0.999729346095	0.97240990991
25	0.0964658670531	0.0889046118416	1.08504907738	0.962345157658
26	0.0859510889363	0.0750195718555	1.14571553543	0.971107826577
27	0.0802285841969	0.07530083667	1.0654408071	0.977266328829
28	0.0748224133915	0.0690793991347	1.08313642459	0.975964245495
29	0.0793211324477	0.0681807974406	1.16339402625	0.977266328829
30	0.0826256836873	0.0624525477598	1.32301541972	0.975014076577
31	0.0853879309299	0.0668691872205	1.27693986542	0.97631615991
32	0.076470658386	0.0646254413504	1.18329030778	0.975014076577
33	0.0760794766555	0.0667853011598	1.13916498592	0.979870495495
34	0.0665415947375	0.0692819801545	0.960445913772	0.98022240991
35	0.0705463625774	0.0742039837075	0.950708561086	0.968855574324
36	0.074046301923	0.0612888133911	1.2081536226	0.980820664414
37	0.0639039315823	0.0529232257824	1.20748368297	0.98022240991
38	0.072587536274	0.0675438452737	1.07467284369	0.977266328829
39	0.0695367925081	0.0569235849629	1.22158139817	0.984726914414
40	0.0671915485947	0.061050921101	1.10058206138	0.978568412162
41	0.0679842193352	0.0636561376306	1.06799158519	0.978568412162
42	0.0593782255528	0.0535851626725	1.10810945776	0.98022240991
43	0.0569964756769	0.0571896531978	0.996622159602	0.983776745495
44	0.0601268831688	0.0484692962809	1.24051487813	0.979870495495
45	0.0589366761822	0.0469076615576	1.25644029621	0.981172578829
46	0.0608893465664	0.0488267182771	1.24704974479	0.980820664414
47	0.0651967961264	0.0594221895901	1.09717929575	0.970157657658
48	0.0519022425411	0.0510104792981	1.01748196165	0.982474662162
49	0.0589513108046	0.0529759042826	1.11279479988	0.979870495495
50	0.0584084476755	0.0455702277187	1.28172384909	0.985078828829
51	0.0523404603235	0.0590490518666	0.886389512939	0.975014076577
52	0.0541040725237	0.0506005668489	1.06923846694	0.982474662162
53	0.0544016911107	0.0493586853274	1.10217058558	0.983776745495
54	0.0579962680442	0.0551508365236	1.05159362396	0.971459740991
55	0.0576424291834	0.0429349586781	1.34255233866	0.98022240991
56	0.0608147015802	0.0435457126788	1.39657150702	0.983776745495
57	0.0618181517452	0.0497344586744	1.24296420214	0.978920326577
58	0.0456269753726	0.0451106993044	1.01144464786	0.981172578829
59	0.0510779850349	0.0476614636444	1.07168309844	0.979272240991
60	0.0437077878391	0.0450780917726	0.969601554112	0.982474662162
61	0.0552521256005	0.0366199823796	1.5087971651	0.98412865991
62	0.0601732059283	0.0462169422158	1.30197289226	0.98022240991
63	0.0508553861655	0.0389441748843	1.30585347659	0.982474662162
64	0.0403081685855	0.0376797426679	1.06975700288	0.989583333333
65	0.0519159538138	0.0431063900355	1.20436793179	0.982826576577
66	0.0511599795786	0.0509460090522	1.00419994678	0.983776745495
67	0.0557680315944	0.0492278773353	1.13285468749	0.976668074324
68	0.0486988982122	0.0418543322762	1.16353303383	0.983776745495
69	0.0474283463616	0.0390342494536	1.21504440397	0.987682995495
70	0.0501725387724	0.042636496622	1.17675097035	0.983776745495
71	0.04705326503	0.0462699582516	1.01692905738	0.978920326577
72	0.0426460256456	0.0442813832948	0.963068957482	0.981172578829
73	0.0394663545853	0.041999894893	0.93967746076	0.986028997748
74	0.0486733091585	0.0420140829084	1.15849985979	0.986380912162
75	0.0435378026875	0.037284029966	1.16773328224	0.988633164414
76	0.0439489476146	0.037422708769	1.17439247613	0.986028997748
77	0.0417994814336	0.040140302862	1.04133448064	0.985078828829
78	0.0476498389801	0.0425418474094	1.12006981083	0.985078828829
79	0.0469142799524	0.0376175788193	1.24713714771	0.985078828829
80	0.0437405484472	0.0350304381394	1.24864405844	0.987331081081
81	0.0514190363052	0.0435225797522	1.18143355927	0.987331081081
82	0.0499095432053	0.0389757633547	1.2805276641	0.986028997748
83	0.0443959488616	0.0434892628351	1.020848503	0.985078828829
84	0.0455904515979	0.0417110083457	1.09300765928	0.982474662162
85	0.0494472328571	0.0462878734246	1.06825458157	0.988633164414
86	0.0398275728348	0.0436721914248	0.911966437576	0.986380912162
87	0.0478977050711	0.0469265477625	1.0206952643	0.979870495495
88	0.0460946321753	0.04197214785	1.09821952262	0.983776745495
89	0.0435692280569	0.0457290703962	0.952768724126	0.977618243243
90	0.0495437315843	0.0452617892763	1.09460391152	0.978920326577
91	0.0441648641428	0.0452594410595	0.975815500788	0.981172578829
92	0.0473119206509	0.0464315329171	1.0189609879	0.983776745495
93	0.0464200495373	0.0546953761846	0.848701531563	0.981524493243
94	0.0417278459055	0.0382895335588	1.08979770781	0.984726914414
95	0.0402246032271	0.0397130773778	1.01288053918	0.985078828829
96	0.0443049373217	0.0322667288949	1.37308425239	0.988633164414
97	0.0420380843445	0.0394993777072	1.06427206667	0.981524493243
98	0.0422296159526	0.0509845953309	0.828281869818	0.98022240991
99	0.0427513998818	0.0354470960248	1.20606212289	0.987682995495
100	0.0400053754568	0.0379874413852	1.05312108418	0.986380912162
101	0.0379526486565	0.0383074803849	0.990737273117	0.987682995495
102	0.0395702669347	0.0333428429377	1.18676943681	0.987331081081
103	0.0431026404024	0.0357820316348	1.2045889636	0.987331081081
104	0.0471910114633	0.0343888635682	1.37227598027	0.988985078829
105	0.0456383055537	0.0398239884188	1.14600037228	0.986380912162
106	0.0403567504418	0.0454011686253	0.888892327306	0.985078828829
107	0.0468322447234	0.0435369315013	1.07569006608	0.983776745495
108	0.0401610854623	0.0352996107009	1.13772035059	0.980574324324
109	0.0457336206893	0.0355370281973	1.28692867719	0.984726914414
110	0.037799229436	0.0380283053684	0.993976173008	0.987682995495
111	0.0362481039932	0.0371807100981	0.974916936699	0.988985078829
112	0.0375678147726	0.0440195236704	0.853435285986	0.985078828829
113	0.0467882877524	0.0294505046151	1.58870920427	0.987682995495
114	0.0442429385299	0.0359719094341	1.22993022127	0.986380912162
115	0.0405099908058	0.0368417831573	1.09956650667	0.982826576577
116	0.0458548895033	0.0291663960184	1.57218222897	0.9921875
117	0.0404314746067	0.0494948202731	0.816882946208	0.985078828829
118	0.0397910987136	0.0397862429974	1.0001220451	0.983776745495
119	0.0365890266174	0.0322351587477	1.13506581133	0.985078828829
120	0.0353622601297	0.0337956644277	1.04635493128	0.983776745495
121	0.0446905808251	0.0362422877744	1.23310595356	0.985078828829
122	0.0382761986613	0.0361399090482	1.05911164885	0.985078828829
123	0.0401754752376	0.0342788400993	1.17201968098	0.98412865991
124	0.0396767900664	0.0380998222781	1.04139042373	0.986380912162
125	0.0400439008032	0.0371118460729	1.07900589813	0.986732826577
126	0.0348127881952	0.0350399746025	0.993516364956	0.986732826577
127	0.0457939322965	0.0320588487602	1.4284334612	0.988985078829
128	0.0397656000367	0.0313461453653	1.26859617261	0.985078828829
129	0.0431184385886	0.0342795269277	1.25784812257	0.986380912162
130	0.0369815415687	0.0430714064515	0.858610029611	0.98412865991
131	0.0361573615777	0.041507589105	0.871102426264	0.981524493243
132	0.0342458236452	0.0415596495838	0.824016178871	0.985078828829
133	0.0380473680497	0.0331541991311	1.14758821045	0.987682995495
134	0.029992686988	0.0386135200956	0.776740553924	0.985078828829
135	0.0378699061381	0.038079644841	0.994492104541	0.985078828829
136	0.0356020898134	0.0311200234876	1.14402515884	0.988633164414
137	0.0393889277573	0.0327176446745	1.2039047477	0.983776745495
138	0.0446153783565	0.0270993623636	1.64636266189	0.990885416667
139	0.0349394236915	0.0437944441048	0.797804936349	0.983776745495
140	0.0337241484859	0.0356239897423	0.946669610279	0.983424831081
141	0.0385080120901	0.0316560943991	1.21644861191	0.985078828829
142	0.0326496648823	0.0378938950876	0.861607517697	0.986380912162
143	0.0376382352093	0.0382204469784	0.984767007841	0.983776745495
144	0.0345954150003	0.032384991474	1.06825456564	0.987331081081
145	0.0357033800868	0.036850313169	0.968875893214	0.986028997748
146	0.0349876607227	0.0469216864725	0.745660766972	0.981524493243
147	0.0369342087973	0.0348377135333	1.06017889957	0.983178490991
148	0.0379472463038	0.0394239112458	0.962543925872	0.98412865991
149	0.0504023618612	0.0313235473329	1.60908856604	0.98803490991
150	0.0357799467106	0.0363003303031	0.985664494284	0.98412865991
151	0.0413901559294	0.03510342319	1.17909172861	0.985078828829
152	0.0285821296701	0.0332958241527	0.858429860124	0.987682995495
153	0.0403489301773	0.0277393094788	1.45457586852	0.984480574324
154	0.0347479308084	0.0398392536825	0.872203357155	0.985078828829
155	0.0365059137692	0.0414743035847	0.880205587891	0.982474662162
156	0.0385581112558	0.0334186170148	1.15379135045	0.987682995495
157	0.0302227650353	0.0358337094681	0.843417147818	0.985078828829
158	0.0316178864984	0.0273160341182	1.15748451483	0.9921875
159	0.0358113027389	0.0275921901819	1.29787822216	0.985078828829
160	0.0283950967677	0.0303513639502	0.935545987795	0.986732826577
161	0.0361506104092	0.0400116009808	0.903503222141	0.986380912162
162	0.0356208374748	0.0283103230269	1.25822787119	0.986380912162
163	0.0373117634227	0.0338325245253	1.1028371056	0.985078828829
164	0.0336271666547	0.0365589606921	0.919806417308	0.986380912162
165	0.0352315999173	0.0386078739909	0.912549598705	0.985078828829
166	0.0319671196415	0.0411120473634	0.777560877934	0.985078828829
167	0.0306348872553	0.0419595271744	0.730105635557	0.985078828829
168	0.03848503885	0.0408929448355	0.941116835796	0.985430743243
169	0.0371396352733	0.044524360592	0.834141911967	0.983178490991
170	0.0398214722531	0.0313565853976	1.26995563287	0.979624155405
171	0.0332421395129	0.0309654091832	1.07352495542	0.986380912162
172	0.0308915009536	0.0291616526936	1.05931928064	0.991237331081
173	0.0327835597031	0.0326029240441	1.00554047418	0.985430743243
174	0.0356478664388	0.0358268169017	0.995005125255	0.98412865991
175	0.0363630639284	0.0254715790829	1.42759362543	0.98803490991
176	0.030729982423	0.0319880549531	0.960670552429	0.987682995495
177	0.0292722553053	0.0277674267538	1.05419402254	0.989935247748
178	0.0317761619199	0.03377098861	0.940930758259	0.986380912162
179	0.0282292637769	0.0292087803895	0.966464994443	0.987682995495
180	0.0294745188002	0.0235415823646	1.25201944133	0.990287162162
181	0.031223281577	0.0225561556373	1.38424659233	0.992539414414
182	0.0339371522825	0.0290934477281	1.16648781539	0.988985078829
183	0.0273240751701	0.0277351294445	0.985179291295	0.991237331081
184	0.0327684955362	0.0353104631752	0.928010923381	0.983776745495
185	0.0306745727384	0.0260527141148	1.17740411242	0.989935247748
186	0.0433870348072	0.020373556563	2.12957588789	0.992539414414
187	0.0314899906679	0.0249560476591	1.26181802095	0.991237331081
188	0.0284681494683	0.026295177758	1.08263765054	0.985430743243
189	0.0274827508582	0.0343687667248	0.799643207398	0.986380912162
190	0.039281427815	0.0263382353776	1.49142215687	0.985782657658
191	0.0370554097653	0.0295913532987	1.25223775308	0.983776745495
192	0.0296452132449	0.0233266805766	1.27087148759	0.991237331081
193	0.0322539039565	0.02722695888	1.18463116276	0.985078828829
194	0.0290032367843	0.0259623421891	1.11712712871	0.988985078829
195	0.0312922909388	0.0345794824621	0.904938093655	0.985078828829
196	0.0318477578865	0.0340560121131	0.93515816769	0.986028997748
197	0.029549258246	0.0455029785095	0.649391736846	0.982826576577
198	0.0261009449199	0.0261436820984	0.998365296123	0.989935247748
199	0.0275871271925	0.0305577417139	0.902786843701	0.988633164414
200	0.0338466927899	0.0384724411572	0.879764625583	0.982474662162
201	0.0304750736726	0.0344302503741	0.88512495092	0.986028997748
202	0.0345459144604	0.0314518079157	1.09837611094	0.985430743243
203	0.0250195818525	0.0347026558339	0.720970232718	0.98412865991
204	0.0292479875369	0.0269355545132	1.08585058171	0.989935247748
205	0.0279416469817	0.0299329218047	0.933475427625	0.986028997748
206	0.0261061732277	0.0276714651068	0.943432995936	0.989935247748
207	0.030804442451	0.0227398108129	1.35464814129	0.991237331081
208	0.0286934737992	0.028396496927	1.01045822211	0.990885416667
209	0.0297843897616	0.0246903639758	1.20631635041	0.991237331081
210	0.028625859134	0.027065502341	1.05765112997	0.988985078829
211	0.0295803024398	0.0419246671349	0.705558432811	0.978568412162
212	0.0324247503712	0.0401620090558	0.807348813804	0.983776745495
213	0.0284511979343	0.041133997841	0.691671109729	0.981172578829
214	0.0311744142056	0.0290071151378	1.07471611905	0.989935247748
215	0.0286446803481	0.0372075648021	0.769861733774	0.983776745495
216	0.0303138413221	0.0433968675743	0.69852602311	0.981172578829
217	0.0270513211572	0.0276263784893	0.979184483689	0.987331081081
218	0.0265352124641	0.0305945501692	0.867318274574	0.984726914414
219	0.026336572259	0.0242056053609	1.0880360919	0.988633164414
220	0.0314486722761	0.0332294711069	0.946409052822	0.983424831081
221	0.0319566511928	0.0267909672978	1.19281438545	0.989935247748
222	0.0269158548345	0.033163790472	0.811603693408	0.986028997748
223	0.0318779051895	0.0226941825566	1.40467298657	0.9921875
224	0.0280503464174	0.0272419942511	1.02967301729	0.986380912162
225	0.0310340832834	0.0202670750667	1.53125614729	0.994791666667
226	0.0236866648614	0.0238181224059	0.994480776348	0.990885416667
227	0.0231357354441	0.0295325423484	0.783398028223	0.98828125
228	0.0275408475428	0.036256907523	0.75960277432	0.985078828829
229	0.0306947869358	0.0245511939344	1.25023601776	0.988985078829
230	0.0315809596714	0.0303699217632	1.03987622746	0.986380912162
231	0.0304527933779	0.0234718858982	1.29741570447	0.988633164414
232	0.0214098067706	0.0365053164674	0.586484623128	0.986979166667
233	0.0331614548179	0.0610295692118	0.543367014484	0.974662162162
234	0.0299856151842	0.0269107259601	1.11426258915	0.987682995495
235	0.0271226099972	0.021176463363	1.28079035353	0.990287162162
236	0.0277582290049	0.0355672106356	0.780444361784	0.982474662162
237	0.0270150757316	0.0279069249873	0.968042009067	0.991237331081
238	0.0273045060416	0.0296682852575	0.920326395832	0.987331081081
239	0.0300592404192	0.0323089032331	0.930370189366	0.986380912162
240	0.022307442465	0.0352324088282	0.633151215228	0.987331081081
241	0.0278896677555	0.032403765388	0.860692188748	0.985078828829
242	0.0318188658198	0.0234643134916	1.356053559	0.990287162162
243	0.0258060374261	0.0266856681217	0.967037336613	0.987682995495
244	0.0230086075329	0.0242788131813	0.947682547787	0.990885416667
245	0.0267404274273	0.0267563947005	0.999403235249	0.989935247748
246	0.0222679056747	0.024811048932	0.897499567056	0.988633164414
247	0.0254935411885	0.0363951213656	0.700465893007	0.985078828829
248	0.0251299933683	0.0255445224381	0.983772291269	0.991237331081
249	0.0280488293479	0.0256898267991	1.09182633138	0.991237331081
250	0.0258716520058	0.0271759178165	0.952006558913	0.988985078829


Confusion Matrix
[[671   0   0]
 [  0 149   6]
 [  0   4  62]]


Report
             precision    recall  f1-score   support

          0       1.00      1.00      1.00       671
          1       0.97      0.96      0.97       155
          2       0.91      0.94      0.93        66

avg / total       0.99      0.99      0.99       892
